<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Probability Distribution Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .slider-container { margin-bottom: 1rem; }
        /* Custom scrollbar for sidebar */
        aside::-webkit-scrollbar { width: 6px; }
        aside::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }
    </style>
</head>
<body class="bg-slate-50 h-screen flex flex-col md:flex-row overflow-hidden">

    <aside class="w-full md:w-64 bg-white border-r border-slate-200 flex flex-col h-1/3 md:h-full overflow-y-auto shrink-0 z-10 shadow-md">
        <div class="p-6 bg-indigo-600 text-white">
            <h1 class="font-bold text-xl">Prob. Explorer</h1>
            <p class="text-xs text-indigo-200 mt-1">Select a distribution</p>
        </div>
        
        <div class="p-4">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Discrete</h3>
            <ul class="space-y-1">
                <li><button onclick="loadDist('bernoulli')" class="w-full text-left px-4 py-2 rounded hover:bg-slate-100 text-slate-700 text-sm font-medium transition" id="btn-bernoulli">Bernoulli</button></li>
                <li><button onclick="loadDist('binomial')" class="w-full text-left px-4 py-2 rounded hover:bg-slate-100 text-slate-700 text-sm font-medium transition" id="btn-binomial">Binomial</button></li>
                <li><button onclick="loadDist('geometric')" class="w-full text-left px-4 py-2 rounded hover:bg-slate-100 text-slate-700 text-sm font-medium transition" id="btn-geometric">Geometric</button></li>
                <li><button onclick="loadDist('poisson')" class="w-full text-left px-4 py-2 rounded hover:bg-slate-100 text-slate-700 text-sm font-medium transition" id="btn-poisson">Poisson</button></li>
            </ul>

            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 mt-6">Continuous</h3>
            <ul class="space-y-1">
                <li><button onclick="loadDist('uniform')" class="w-full text-left px-4 py-2 rounded hover:bg-slate-100 text-slate-700 text-sm font-medium transition" id="btn-uniform">Uniform</button></li>
                <li><button onclick="loadDist('normal')" class="w-full text-left px-4 py-2 rounded hover:bg-slate-100 text-slate-700 text-sm font-medium transition" id="btn-normal">Normal (Gaussian)</button></li>
                <li><button onclick="loadDist('exponential')" class="w-full text-left px-4 py-2 rounded hover:bg-slate-100 text-slate-700 text-sm font-medium transition" id="btn-exponential">Exponential</button></li>
            </ul>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-full overflow-y-auto p-6 md:p-10 relative">
        
        <div class="max-w-4xl mx-auto w-full mb-8">
            <div class="flex items-center gap-3 mb-2">
                <span id="dist-type-badge" class="px-2 py-1 text-xs font-bold rounded bg-blue-100 text-blue-800 uppercase">Discrete</span>
                <h2 id="dist-title" class="text-3xl font-bold text-slate-800">Bernoulli Distribution</h2>
            </div>
            <p id="dist-desc" class="text-slate-600 text-lg leading-relaxed">
                The simplest discrete distribution. It models a single experiment with two possible outcomes: Success (1) or Failure (0).
            </p>
        </div>

        <div class="max-w-4xl mx-auto w-full grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
            
            <div class="lg:col-span-2 bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                <div class="relative h-64 w-full">
                    <canvas id="distChart"></canvas>
                </div>
            </div>

            <div class="bg-slate-100 p-6 rounded-xl border border-slate-200 h-fit">
                <h3 class="font-bold text-slate-700 mb-4 border-b border-slate-300 pb-2">Parameters</h3>
                <div id="controls-area">
                    </div>
                <div class="mt-6 text-sm text-slate-500 bg-white p-3 rounded border border-slate-200">
                    <strong class="block text-slate-700 mb-1">Visual Intuition:</strong>
                    <span id="visual-explanation">Change the probability <em>p</em> to see the balance shift between 0 and 1.</span>
                </div>
            </div>
        </div>

        <div class="max-w-4xl mx-auto w-full grid grid-cols-1 md:grid-cols-2 gap-8 pb-10">
            <div class="prose prose-slate">
                <h3 class="text-lg font-bold text-slate-800">Real World Example</h3>
                <p id="dist-example" class="text-slate-600">A single coin flip. Heads is 1, Tails is 0.</p>
            </div>
            <div class="bg-slate-800 text-slate-200 p-6 rounded-lg">
                <h3 class="text-sm font-bold text-slate-400 uppercase mb-2">Formula</h3>
                <div id="dist-formula" class="text-lg text-center py-2">
                    $$ P(x) = p^x (1-p)^{1-x} $$
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- DATA & LOGIC ---

        const distributions = {
            // --- DISCRETE ---
            bernoulli: {
                title: "Bernoulli Distribution",
                type: "Discrete",
                desc: "The Bernoulli distribution is the discrete probability distribution of a random variable which takes the value 1 with probability p and the value 0 with probability q = 1 - p.",
                example: "Flipping a single coin (Heads/Tails) or a single basketball free-throw (Make/Miss).",
                formula: "$$ P(X=k) = p^k (1-p)^{1-k} \\quad \\text{for } k \\in \\{0,1\\} $$",
                visualHint: "Since it is discrete, we use bars. Notice there are only two bars at 0 and 1.",
                params: [
                    { name: 'p', label: 'Probability (p)', min: 0, max: 1, step: 0.01, val: 0.5 }
                ],
                calc: (params) => {
                    const p = params.p;
                    return {
                        labels: [0, 1],
                        data: [1-p, p],
                        chartType: 'bar'
                    };
                }
            },
            binomial: {
                title: "Binomial Distribution",
                type: "Discrete",
                desc: "Models the number of successes in a fixed number of independent trials (n), each with the same probability of success (p).",
                example: "Flipping a coin 10 times and counting how many times it lands on Heads.",
                formula: "$$ P(X=k) = \\binom{n}{k} p^k (1-p)^{n-k} $$",
                visualHint: "Watch how the 'bell shape' forms as n increases. If p < 0.5, it skews right; if p > 0.5, it skews left.",
                params: [
                    { name: 'n', label: 'Trials (n)', min: 1, max: 20, step: 1, val: 10 },
                    { name: 'p', label: 'Probability (p)', min: 0, max: 1, step: 0.01, val: 0.5 }
                ],
                calc: (params) => {
                    const n = parseInt(params.n);
                    const p = params.p;
                    let labels = [];
                    let data = [];
                    
                    // Factorial helper
                    const factorial = (num) => num <= 1 ? 1 : num * factorial(num - 1);
                    // Combination helper
                    const nCr = (n, r) => factorial(n) / (factorial(r) * factorial(n - r));

                    for(let k=0; k<=n; k++) {
                        labels.push(k);
                        let prob = nCr(n, k) * Math.pow(p, k) * Math.pow(1-p, n-k);
                        data.push(prob);
                    }
                    return { labels, data, chartType: 'bar' };
                }
            },
            geometric: {
                title: "Geometric Distribution",
                type: "Discrete",
                desc: "Models the number of failures before the first success occurs in a sequence of independent Bernoulli trials.",
                example: "How many times you have to roll a die until you finally get a '6'.",
                formula: "$$ P(X=k) = (1-p)^k p $$",
                visualHint: "It always starts highest at k=0 (success on 1st try) and decays. Lower p means a longer 'tail'.",
                params: [
                    { name: 'p', label: 'Probability (p)', min: 0.1, max: 0.9, step: 0.05, val: 0.5 }
                ],
                calc: (params) => {
                    const p = params.p;
                    let labels = [];
                    let data = [];
                    // Show first 15 trials for visualization
                    for(let k=0; k<15; k++) {
                        labels.push(k); // k = failures before success
                        let prob = Math.pow(1-p, k) * p;
                        data.push(prob);
                    }
                    return { labels, data, chartType: 'bar' };
                }
            },
            poisson: {
                title: "Poisson Distribution",
                type: "Discrete",
                desc: "Models the number of events occurring in a fixed interval of time or space, given a constant mean rate (λ).",
                example: "Number of emails arriving in your inbox in one hour.",
                formula: "$$ P(X=k) = \\frac{\\lambda^k e^{-\\lambda}}{k!} $$",
                visualHint: "As λ increases, the peak moves to the right and the distribution becomes more symmetric.",
                params: [
                    { name: 'lambda', label: 'Rate (λ)', min: 1, max: 15, step: 0.5, val: 4 }
                ],
                calc: (params) => {
                    const lambda = params.lambda;
                    let labels = [];
                    let data = [];
                    const factorial = (num) => num <= 1 ? 1 : num * factorial(num - 1);
                    
                    // Show enough range to see the curve
                    let maxK = Math.max(15, lambda * 2 + 5); 
                    for(let k=0; k<maxK; k++) {
                        labels.push(k);
                        let prob = (Math.pow(lambda, k) * Math.exp(-lambda)) / factorial(k);
                        data.push(prob);
                    }
                    return { labels, data, chartType: 'bar' };
                }
            },
            
            // --- CONTINUOUS ---
            uniform: {
                title: "Continuous Uniform",
                type: "Continuous",
                desc: "A distribution where all outcomes within a range [a, b] are equally likely. It looks like a rectangle.",
                example: "Waiting for a bus that comes exactly every 15 minutes; your wait time is uniform between 0 and 15.",
                formula: "$$ f(x) = \\frac{1}{b-a} \\quad \\text{for } a \\le x \\le b $$",
                visualHint: "The height is constant (flat). The wider the range (b-a), the shorter the rectangle (to keep area = 1).",
                params: [
                    { name: 'a', label: 'Min (a)', min: 0, max: 4, step: 1, val: 1 },
                    { name: 'b', label: 'Max (b)', min: 5, max: 10, step: 1, val: 6 }
                ],
                calc: (params) => {
                    let a = parseFloat(params.a);
                    let b = parseFloat(params.b);
                    if(a >= b) b = a + 1; // Basic validation
                    
                    const height = 1 / (b - a);
                    let labels = [];
                    let data = [];
                    
                    // Generate points for line chart
                    // We draw 0 before a, then jump up, go to b, then jump down
                    labels = [a-1, a, a, b, b, b+1];
                    data = [0, 0, height, height, 0, 0];
                    
                    return { labels, data, chartType: 'line', fill: true };
                }
            },
            normal: {
                title: "Normal Distribution",
                type: "Continuous",
                desc: "Also known as the Gaussian or Bell Curve. It is symmetric and describes many natural phenomena.",
                example: "Human heights, IQ scores, measurement errors.",
                formula: "$$ f(x) = \\frac{1}{\\sigma\\sqrt{2\\pi}} e^{-\\frac{1}{2}(\\frac{x-\\mu}{\\sigma})^2} $$",
                visualHint: "μ moves the center left/right. σ controls the width/spread. Higher σ = flatter curve.",
                params: [
                    { name: 'mu', label: 'Mean (μ)', min: -5, max: 5, step: 0.5, val: 0 },
                    { name: 'sigma', label: 'Std Dev (σ)', min: 0.5, max: 3, step: 0.1, val: 1 }
                ],
                calc: (params) => {
                    const mu = parseFloat(params.mu);
                    const sigma = parseFloat(params.sigma);
                    let labels = [];
                    let data = [];
                    
                    // Generate range -4std to +4std
                    const start = mu - (4 * sigma);
                    const end = mu + (4 * sigma);
                    const steps = 100;
                    const stepSize = (end - start) / steps;
                    
                    for(let i=0; i<=steps; i++) {
                        let x = start + (i * stepSize);
                        labels.push(x.toFixed(2));
                        let num = Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));
                        let den = sigma * Math.sqrt(2 * Math.PI);
                        data.push(num / den);
                    }
                    return { labels, data, chartType: 'line', fill: true, pointRadius: 0 };
                }
            },
            exponential: {
                title: "Exponential Distribution",
                type: "Continuous",
                desc: "Models the time between events in a Poisson point process (events occur continuously and independently at a constant rate).",
                example: "Time until the next customer arrives at a store, or time until a lightbulb fails.",
                formula: "$$ f(x) = \\lambda e^{-\\lambda x} \\quad \\text{for } x \\ge 0 $$",
                visualHint: "It starts at its maximum value (λ) at x=0 and decays exponentially. It never touches zero.",
                params: [
                    { name: 'lambda', label: 'Rate (λ)', min: 0.1, max: 3, step: 0.1, val: 1 }
                ],
                calc: (params) => {
                    const lambda = parseFloat(params.lambda);
                    let labels = [];
                    let data = [];
                    
                    const end = 5 / lambda; // Show effective tail
                    const steps = 100;
                    const stepSize = end / steps;
                    
                    for(let i=0; i<=steps; i++) {
                        let x = i * stepSize;
                        labels.push(x.toFixed(2));
                        data.push(lambda * Math.exp(-lambda * x));
                    }
                    return { labels, data, chartType: 'line', fill: true, pointRadius: 0 };
                }
            }
        };

        // --- CHART SETUP ---
        const ctx = document.getElementById('distChart').getContext('2d');
        let chartInstance = null;
        let currentDist = 'bernoulli';
        let currentParams = {};

        function initChart(type, labels, data, fill, pointRadius) {
            if (chartInstance) chartInstance.destroy();
            
            const isDiscrete = type === 'bar';
            
            chartInstance = new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Probability',
                        data: data,
                        backgroundColor: isDiscrete ? 'rgba(79, 70, 229, 0.6)' : 'rgba(79, 70, 229, 0.2)', // Indigo
                        borderColor: 'rgba(79, 70, 229, 1)',
                        borderWidth: 2,
                        fill: fill || false,
                        pointRadius: pointRadius !== undefined ? pointRadius : 3,
                        tension: 0.4 // Smooth curves for continuous
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: { duration: 200 }, // Fast animation for sliders
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: isDiscrete ? 'Probability P(x)' : 'Density f(x)' } },
                        x: { title: { display: true, text: 'Outcome (x)' }, ticks: { maxTicksLimit: 10 } }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        // --- UI UPDATES ---
        
        function renderControls(distKey) {
            const container = document.getElementById('controls-area');
            container.innerHTML = '';
            
            const params = distributions[distKey].params;
            currentParams = {};

            params.forEach(p => {
                currentParams[p.name] = p.val;
                
                // Create slider elements
                const wrapper = document.createElement('div');
                wrapper.className = 'slider-container';
                
                const labelRow = document.createElement('div');
                labelRow.className = 'flex justify-between mb-1';
                
                const label = document.createElement('label');
                label.className = 'text-sm font-medium text-slate-700';
                label.innerText = p.label;
                
                const valDisplay = document.createElement('span');
                valDisplay.className = 'text-sm font-bold text-indigo-600';
                valDisplay.innerText = p.val;
                valDisplay.id = `val-${p.name}`;
                
                labelRow.appendChild(label);
                labelRow.appendChild(valDisplay);
                
                const input = document.createElement('input');
                input.type = 'range';
                input.min = p.min;
                input.max = p.max;
                input.step = p.step;
                input.value = p.val;
                input.className = 'w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600';
                
                // Event Listener
                input.addEventListener('input', (e) => {
                    const val = parseFloat(e.target.value);
                    document.getElementById(`val-${p.name}`).innerText = val;
                    currentParams[p.name] = val;
                    updateGraph();
                });

                wrapper.appendChild(labelRow);
                wrapper.appendChild(input);
                container.appendChild(wrapper);
            });
        }

        function updateGraph() {
            const dist = distributions[currentDist];
            const result = dist.calc(currentParams);
            
            // Re-init chart if type changes (bar <-> line) or update data
            // For simplicity, we just re-init lightly or update data
            // Ideally we check type but chartjs handle destroy well
            initChart(result.chartType, result.labels, result.data, result.fill, result.pointRadius);
        }

        function loadDist(key) {
            currentDist = key;
            const data = distributions[key];
            
            // Highlight active button
            document.querySelectorAll('aside button').forEach(b => {
                b.classList.remove('bg-indigo-50', 'text-indigo-700');
                b.classList.add('text-slate-700');
            });
            document.getElementById(`btn-${key}`).classList.add('bg-indigo-50', 'text-indigo-700');
            document.getElementById(`btn-${key}`).classList.remove('text-slate-700');

            // Text Content
            document.getElementById('dist-title').innerText = data.title;
            document.getElementById('dist-desc').innerText = data.desc;
            document.getElementById('dist-example').innerText = data.example;
            document.getElementById('dist-formula').innerHTML = data.formula;
            document.getElementById('visual-explanation').innerText = data.visualHint;

            // Badge
            const badge = document.getElementById('dist-type-badge');
            badge.innerText = data.type;
            if(data.type === 'Continuous') {
                badge.className = 'px-2 py-1 text-xs font-bold rounded bg-orange-100 text-orange-800 uppercase';
            } else {
                badge.className = 'px-2 py-1 text-xs font-bold rounded bg-blue-100 text-blue-800 uppercase';
            }

            // Reprocess MathJax
            if(window.MathJax) {
                MathJax.typesetPromise();
            }

            // Setup Controls & Initial Graph
            renderControls(key);
            updateGraph();
        }

        // --- INIT ---
        window.onload = () => {
            loadDist('bernoulli');
        };

    </script>
</body>
</html>
